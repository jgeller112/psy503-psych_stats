<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>PSY 503: Foundations of Statistical Methods in Psychological Science</title>
    <meta charset="utf-8" />
    <meta name="author" content="Jason Geller, Ph.D.(he/him/his)" />
    <meta name="date" content="2022-09-11" />
    <script src="lecture2_intro_causality_potential_outcomes_handout_files/header-attrs/header-attrs.js"></script>
    <link href="lecture2_intro_causality_potential_outcomes_handout_files/countdown/countdown.css" rel="stylesheet" />
    <script src="lecture2_intro_causality_potential_outcomes_handout_files/countdown/countdown.js"></script>
    <script src="lecture2_intro_causality_potential_outcomes_handout_files/kePrint/kePrint.js"></script>
    <link href="lecture2_intro_causality_potential_outcomes_handout_files/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# PSY 503: Foundations of Statistical Methods in Psychological Science
]
.subtitle[
## Casuality, Potential Outcomes, and Experiments
]
.author[
### Jason Geller, Ph.D.(he/him/his)
]
.institute[
### Princeton University
]
.date[
### 2022-09-11
]

---





# Today

.blockquote[
## &lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M444.52 3.52L28.74 195.42c-47.97 22.39-31.98 92.75 19.19 92.75h175.91v175.91c0 51.17 70.36 67.17 92.75 19.19l191.9-415.78c15.99-38.39-25.59-79.97-63.97-63.97z"&gt;&lt;/path&gt;&lt;/svg&gt; Aim

- Working definition of causality

- Look at a method to formally explain causation 

- Better understand the role causality in psychology

]
---
# Heider and Simmel (1944)

- What is going on here?
&lt;br&gt;
&lt;br&gt;

&lt;center&gt;
&lt;iframe width="600" height="400" src="https://www.youtube.com/embed/VTNmLt7QX8E" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;&lt;/iframe&gt;
&lt;center&gt;
---
# Causal Relationships?

--

- Lighting fireworks causes noise
--

- Rooster crows cause the sunrise
--

- Getting a Ph.D. from Princeton increases your earnings

--
- Colds go away a few days after you take vitamin C

--
- Hurricanes with female names cause more deaths

---

class: middle center


 How do we know if **X** causes **Y**?

--

.box-inv-3.medium[**X** causes **Y** if‚Ä¶]

--

.box-inv-3.medium[‚Ä¶we intervene and change **X**&lt;br&gt;without changing anything else‚Ä¶]

--

.box-inv-3.medium[‚Ä¶and **Y** changes]

---
# **Y** "listens to" **X**

&lt;br&gt;
&lt;br&gt;

&gt; "A variable **X** is a cause of a variable **Y** if **Y** in any way relies on **X** for its value.‚Ä¶ **X** is a cause of **Y** if **Y** listens to **X** and decides its value in response to what it hears" - &lt;br&gt;-Pearl, Glymour, and Jewell 2016, 5‚Äì6

---
class: middle center 

&gt; __Causation = Correlation + time order + nonspuriousness__
--
---
# Disclaimer: Causality is NOT Correlation?

 &gt; Associations:

  - Describes the world as it happened
  
  - No meaningful directionality

&lt;img src="nickcage.jpeg" width="75%" style="display: block; margin: auto;" /&gt;
---

&lt;br&gt;
&lt;br&gt;
&lt;br&gt;
&lt;img src="hurricane.png" width="75%" style="display: block; margin: auto;" /&gt;
---
# Causality in Psychology 

&lt;br&gt;
&lt;br&gt;

- Psychology and social sciences: 

    - Generally interested in __identifying__ and __quantifying__ causal relationships  
    
    - What does this mean?
---
# "Causes of Effects" or "Effects of Causes"? 

--
- Psychology studies generally focus on the __"effects of causes"__  
--

- __Effects__ have __many causes__   

  - Brain chemistry  
  - Hormones  
  - Sensory cues  
  - Prenatal environment  
  - Early experiences  
  - Genes  
--

**list goes on and on**

---

# What do we learn from studies of the effects of causes? 

- Causal relationships   

  - Manipulating `\(X\)` üí•  `\(Y\)`   

- Direction of effects  

  - Manipulating `\(X\)` ‚¨ÜÔ∏è/ ‚¨áÔ∏è `\(Y\)` 
  - Manipulating `\(X\)`  ‚¨ÜÔ∏è/ ‚¨áÔ∏è the probability of `\(Y\)`   
  
- Magnitude of effects

---
class: middle center


# .blockquote[
### &lt;svg viewBox="0 0 512 512" style="height:1em;position:relative;display:inline-block;top:.1em;" xmlns="http://www.w3.org/2000/svg"&gt;  &lt;path d="M144 208c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm112 0c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zm112 0c-17.7 0-32 14.3-32 32s14.3 32 32 32 32-14.3 32-32-14.3-32-32-32zM256 32C114.6 32 0 125.1 0 240c0 47.6 19.9 91.2 52.9 126.3C38 405.7 7 439.1 6.5 439.5c-6.6 7-8.4 17.2-4.6 26S14.4 480 24 480c61.5 0 110-25.7 139.1-46.3C192 442.8 223.2 448 256 448c141.4 0 256-93.1 256-208S397.4 32 256 32zm0 368c-26.7 0-53.1-4.1-78.4-12.1l-22.7-7.2-19.5 13.8c-14.3 10.1-33.9 21.4-57.5 29 7.3-12.1 14.4-25.7 19.9-40.2l10.6-28.1-20.6-21.8C69.7 314.1 48 282.2 48 240c0-88.2 93.3-160 208-160s208 71.8 208 160-93.3 160-208 160z"&gt;&lt;/path&gt;&lt;/svg&gt;
]

## Take a few minutes and think about causality in your research 

<div class="countdown" id="timer_33218c63" data-update-every="1" tabindex="0" style="right:0;bottom:0;">
<div class="countdown-controls"><button class="countdown-bump-down">&minus;</button><button class="countdown-bump-up">&plus;</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">05</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
---
# Basic Concept 

- Notion of causality is tied to an __action__ applied to a __unit__

--

- In Psychology: 

  - __Unit__: Target of study (__individual__ , __classrooms__)
  
      - **i**  
  
  - __Treatment__: Intervention received by one group of units but not the other
  
      - **d** or **z** 
  
  - __Response__: Outcome of study
  
      - **Y** 

---
class: center middle

# The Rubin Causal Model: A Powerful Framework to Study Causal Effects and Threats to Causal Inference

---
# Rubin Causal Model

- Framework developed by Donald Rubin (Rubin, 1974, 1975)   

- Mathematical definition of causal effects at the individual level 

- Establishes the impossibility of measuring causal effects for an individual 


.footnote[[1].Other Theories: Judea Pearl's **The Book of Why**]


---
What is Causality (Formally)? 

- Let `\(d_i\)` be a treatment (e.g., testing)  

- Let `\(Y_i\)` be an outcome (e.g., performance on  test)  

&lt;br&gt;
&lt;br&gt;

&gt; A treatment `\(d_i\)` has a causal effect on an outcome `\(Y_i\)`   for individual `\(i\)` (e.g., student) if the action of `\(d_i\)` on  individual `\(i\)` impacts `\(Y_i\)` (i.e., the extent to which a student using quizzing affects performance)

---
# Core Concept: Potential Outcomes (Counterfactuals) 

- Each individual has different __potential outcomes__ in alternative environments 

- To measure the causal effect of a treatment `\(d_i\)` for individual `\(i\)`:  

  - Measure the outcome of interest `\(Y_i\)` for individual `\(i\)` in two environments `\(E_0\)` and `\(E_1\)` that differ on one aspect: `\(d_i\)`  
--

- Example: 

  - Does the minimum wage increase with the unemployment rate?
    
      - Unemployment rate went up after the minimum wage increased
        
      - Would the unemployment rate have gone up, had the minimum wage increase not occurred?

---
# Potential Outcomes Notation

- `\(E_0\)`: `\(d_i = 0\)`, treatment was not applied to individual `\(i\)`        

- `\(E_1\)`: `\(d_i = 1\)`, treatment was applied to individual `\(i\)` 

- Imagine we can observe both `\(Y_i(0)\)` and `\(Y_i(1)\)` for the exact same individual `\(i\)` in `\(E_0\)` and `\(E_1\)`, respectively.  

- For individual `\(i\)`, the causal effect `\(\tau_i\)` of the treatment `\(d_i\)` is defined as the difference between two potential outcomes:   

\begin{equation}    
\tau_i = Y_i(1) - Y_i(0)   
\end{equation}  

---
# Implications 

- If `\(\tau_i = 0\)`, using testing has no causal effect on `\(Y_i\)`  

- If `\(\tau_i \neq 0\)`, testing has a causal effect on `\(Y_i\)`  

- The _magnitude_ of the causal effect for individual `\(i\)` is `\(\tau_i\)`, such that `$$\tau_i = Y_i(1) - Y_i(0)$$`      

---
class: middle center

# Anyone see a problem here?

---
# Fundamental Problem of Causal Inference (Holland, 1986) 

&lt;img src="potentialoutcomes.JPG" width="40%" height="3%" style="display: block; margin: auto;" /&gt;

--
- Prediction problem (do we care about this at individual level?)

---
class: center middle main-title section-title-7

# Causal Effects in Populations (ATE)
---
# Population

&lt;br&gt;
&lt;br&gt;

- A **population** is a set of units defined a priori by the researcher
 
 &gt; The term population refers to the entire group of individuals from a specified group
 
---
# Average Treatment Effect

.box-inv-7.medium[Solution: Use averages instead]

$$
\text{ATE} = E(Y_1 - Y_0) = E(Y_1) - E(Y_0)
$$

 &gt; .box-7[Difference between average/expected value when&lt;br&gt;program is on vs. expected value when program is off]

$$
\delta = (\bar{Y}\ |\ P = 1) - (\bar{Y}\ |\ P = 0)
$$
---
# Hypothetical Scenario: Set Up

- Let our _population of interest_ be students in this class (**N** = 8) 

--

- Let `\(Y_i\)` be performance on test for a student `\(i\)` 

--

- Let `\(\tau_i\)` be the effect of quizzing or testing for individual `\(i\)`  
---
# Hypothetical schedule of potential outcomes

&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Student &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(Y_i\)`(0) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(Y_i\)`(1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(\tau_i\)` &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 61 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 49 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 95 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; -93 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 27 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 19 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 91 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 78 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 66 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 62 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 42 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 48 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Average Treatment Effect (ATE) in the population 

- ATE in this population? 

- Take the average of the last column 

.pull-left.small[
`\(\delta = (\bar{Y}\ |\ P = 1) - (\bar{Y}\ |\ P = 0)\)`
]

--

```r
avg
```

```
## [1] 18.25
```

- __Conclusion:__ on average in this population, the use of quizzing increases test performance by 18.25 points.

---
# ATE: Formal Defintion  

\begin{equation} 
  \mathrm{ATE} = \frac{1}{N} \sum_{i=1}^{N} \tau_i
\end{equation} 

- Population ATE is defined as the sum of `\(\tau_i\)` divided by N, the number of individuals `\(i\)` the population  

- Describes how the outcome of interest `\(Y_i\)` would change on average in the population if the treatment was applied to every single individual in the population. 

- It is an extremely important concept in psychology   

  - Identify and quantify average effects of treatments in populations  
---
# Problems? 

&lt;br&gt;

&lt;br&gt;

- `\(\tau_i\)` is forever unknown    

- We generally don't have access to the entire population of interest  

- How do we __estimate__ population average treatment effects?
---
class: middle center

# Experimental Design
---
# Experimental Design

- What is an experiment?

  &gt; __Experiment__: Any study conducted under controlled conditions to measure the impact of a novel treatment or other manipulation

  &gt; __Randomized experiment__: Chance process determines assignment of units to treatment conditions (e.g., coin flip, random number generator)


---
# Random?

&lt;br&gt;
&lt;br&gt;

- Every person (or unit) has some chance (i.e., a non-zero probability) of being selected into the treatment or control group

- The selection is based upon a random process (e.g., names out of a hat, a random number generator, rolls of dice, etc.)
---
# Experimental Design

-  Why randomized experiments? 

    - Random assignment ensures that outcomes of the untreated (control) group are an appropriate counterfactual for the treated (experimental) group
    
    - Randomization ensures groups are identical (on average) and thus there is no selection bias in the estimate of the ATE
    
    - Balances all observed variables as well as unobserved variables

---
# Experimental Design

- Helps us: 

    - Identify the presence of causal effects  
  
        - Does a causal effect exist at all? 
  
  - Statistical significance 

      - Estimate the magnitude of causal effects   
      - What is the direction of the causal effect? 

  - Practical significance  
  
      - Is the causal effect relevant?  
  
---
# Random Porcesses in R

- Sampling without replacement


```r
# set.seed?
#sample(x, size, replace = FALSE, prob = NULL)

sample(1:10, 5)
```

```
## [1] 10  6  7  1  4
```

- Sampling with  Replacement

```r
sample(1:10, 5, replace = TRUE)
```

```
## [1]  8 10  8  7  2
```
---
# Randomization Magic

- Simulation in R

  - Randomly assigns individuals from a population of size `\(N = 500\)` to one of two groups 

  - Repeat this many many times: 100,000 times 

  - Compare the average characteristics of the individuals that are assigned to each group  

**Open R Studio**
---
# Randomization Magic

&lt;br&gt;
&lt;br&gt;


```r
library(tidyverse)

# Simulate age of 500 participants (range: 18-99)
# store in an object called: age_vector

age_vector &lt;- sample(18:99, 
                     size = 500, 
                     replace = TRUE)

head(age_vector)
```

```
## [1] 77 44 37 97 81 37
```
---

```r
# Randomly assign each individual to an experimental group
# store in an object called: random_assign
# experimental groups are called: "treatment" vs. "control"

condition &lt;- c("control", "treatment")

random_assign &lt;- sample(condition, 
                        size = 500, 
                        replace = TRUE)

head(random_assign)
```

```
## [1] "treatment" "treatment" "control"   "treatment" "treatment" "treatment"
```
---

```r
 #Put these two vectors into a dataset (tibble) 
# call this dataset: assignment_tibble

assignment_tibble &lt;- tibble(age_vector, 
                            random_assign)

# Calculate mean for each experimental group 

assignment_tibble %&gt;%
  group_by(random_assign) %&gt;%
  summarise(mean = mean(age_vector))
```

```
## # A tibble: 2 √ó 2
##   random_assign  mean
##   &lt;chr&gt;         &lt;dbl&gt;
## 1 control        57.2
## 2 treatment      59.6
```
---

```r
#################################################################
### simulate characteristics of group for 100,000 experiments ###
#################################################################

control_container &lt;- rep(NA, 100000)
# create container in which we will store each of the 100,000 average age of treatment
treatment_container &lt;- rep(NA, 100000)
# write for loop
for (i in 1:100000){
  
  age_vector &lt;- sample(18:99, 
                       size = 500, 
                       replace = TRUE)
  
  random_assign &lt;- sample(c("control", "treatment"), 
                          size = 500, 
                          replace = TRUE)
  
  control_container[i] &lt;- mean(age_vector[random_assign == "control"])
  
  treatment_container[i] &lt;- mean(age_vector[random_assign == "treatment"])
  
}

mean(control_container)
```

```
## [1] 58.49775
```

```r
mean(treatment_container)
```

```
## [1] 58.49937
```
---
# Sample Practice



```r
# imagine you are writing paper and need to decide the author order of 5 authors. How would you do this?

#Find 10 random numbers between 0 and 100

# Draw 5 random letters from uppercase alphabets
```

---
# Randomization Magic


```r
ed_data &lt;- read_csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vTQ9AvbzZ2DBIRmh5h_NJLpC_b4u8-bwTeeMxwSbGX22eBkKDt7JWMqnuBpAVad6-OXteFcjBY4dGqf/pub?gid=300215043&amp;single=true&amp;output=csv")

glimpse(ed_data)
```

```
## Rows: 335
## Columns: 10
## $ ID           &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17‚Ä¶
## $ FEMALE       &lt;dbl&gt; 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 0, 1, 0, ‚Ä¶
## $ MINORITY     &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, ‚Ä¶
## $ MOM_ED       &lt;chr&gt; "Some college", "Vocational/technical program", "Some col‚Ä¶
## $ DAD_ED       &lt;chr&gt; "Vocational/technical program", "Some college", "Bachelor‚Ä¶
## $ SES_CONT     &lt;dbl&gt; -0.27, -0.03, 0.48, -0.03, -0.66, 1.53, 0.20, 0.07, -0.32‚Ä¶
## $ READ_pre     &lt;dbl&gt; 27.40, 32.48, 48.25, 43.86, 36.12, 95.84, 33.81, 33.08, 3‚Ä¶
## $ MATH_pre     &lt;dbl&gt; 18.68, 30.58, 31.57, 31.41, 24.24, 49.75, 27.10, 27.35, 2‚Ä¶
## $ Trt_rand     &lt;dbl&gt; 1, 0, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, ‚Ä¶
## $ Trt_non_rand &lt;dbl&gt; 1, 1, 0, 1, 1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, ‚Ä¶
```
---


```r
ed_data %&gt;% 
  group_by(Trt_rand) %&gt;% 
  summarise_if(is.numeric, mean) %&gt;% 
  select(-c(ID, Trt_non_rand))
```

```
## # A tibble: 2 √ó 6
##   Trt_rand FEMALE MINORITY SES_CONT READ_pre MATH_pre
##      &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
## 1        0  0.542    0.327    0.296     46.8     39.0
## 2        1  0.569    0.293    0.320     48.2     39.9
```

```r
# Experimental set up  
```

---
# Example 

- Let our population of interest be all students in this class (**N** = 8)  

- Let's imagine that we can run an experiment on the entire population of interest  

- __Random assignment:__  

  - Control (restudy) vs. Treatment condition (testing)

- Let `\(z_i\)` indicate assignment of student `\(i\)` to an experimental condition  
  - `\(z_i = 0\)` if student `\(i\)` was assigned to the control condition  
  - `\(z_i = 1\)` if student `\(i\)` was assigned to the treatment condition  
  - Assume _two sided compliance_: `\(d_i = z_i\)`  
  
---
# Hypothetical Experimental Dataset 

&lt;table class=" lightable-material-dark" style='font-family: "Source Sans Pro", helvetica, sans-serif; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Student &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(Z_i\)` &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(Y_i\)` &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 32 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 49 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 46 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 91 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 66 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 53 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 80 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 57 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
---
# Hypothetical Experimental Dataset with Potential Outcomes

&lt;table class=" lightable-material-dark" style='font-family: "Source Sans Pro", helvetica, sans-serif; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Student &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(Y_i\)`(1) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(Y_i\)`(0) &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; `\(\tau_i\)` &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 32 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 49 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 46 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 91 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 66 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 53 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 57 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; NA &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; ? &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

---
# Potential and Observed Outcomes : Switching Equation

- Causal inference is a missing data problem! 

- Observed outcome `\(Y_i\)` -&gt; Underlying potential outcomes

\begin{equation} 
  Y_i = Y_i(1)z_i + Y_i(0)(1-z_i)
\end{equation} 

- Treatment Applied: `$$Y_i = 1 * Y^1_i  + 0 * Y^0_i$$`
  `$$Y_i = Y^1_i$$`
- Treatment Not Applied: `$$Y_i = 0 * Y1_i + 0 * Y_i0$$`
  `$$Y_i = Y^0_i$$`

???
The switching equation works a lot like Schrodinger‚Äôs cat paradox. Schrodinger‚Äôs cat is placed in a sealed box and receives a dose of poison when an atom emits a radiation. As long as the box is sealed, there is no way we can know whether the cat is dead or alive. When we open the box, we observe either a dead cat or a living cat, but we cannot observe the cat both alive and dead at the same time. The switching equation is like opening the box, it collapses the observed outcome into one of the two potential ones.
---
# Urn Example

---
# Estimation of the ATE: Samples

First, let's work in previous equation to express the ATE with regards to `\(Y_i(0)\)` and `\(Y_i(1)\)`: 

`\begin{equation}
    \begin{split}
\mathrm{ATE} &amp;= \frac{1}{N} \sum_{i=1}^{n}{\tau_i} \\
&amp;= \frac{1}{N} \sum_{i=1}^{n}{(Y_{i}(1) - Y_{i}(0))} \\
&amp;= \frac{1}{N} \sum_{i=1}^{n}{Y_{i}(1)} - \frac{1}{N} \sum_{i=1}^{n}{Y_{i}(0)} \\
&amp;= \mu_{Y(1)} - \mu_{Y(0)}
    \end{split}
\end{equation}`

in which `\(\mu_{Y(1)}\)` is the average value of `\(Y_i(1)\)` for all individuals and `\(\mu_{Y(0)}\)` is the average value of `\(Y(0)\)` for all subjects.
---
# Estimation of the ATE in experiments   

In experimental studies, researchers estimate `\(\mu_{Y_i(1)}\)` using the mean `\(\widehat{\mu}_{Y(1)}\)` of all observed `\(Y_i(1)\)` and `\(Y_i(0)\)` using the mean `\(\widehat{\mu}_{Y(0)}\)` of observed `\(Y_i(0)\)`. We have:  

`\begin{equation}
\widehat{\mathrm{ATE}} = \widehat{\mu}_{Y(1)} - \widehat{\mu}_{Y(0)}
\end{equation}`

in which `\(\widehat{\mathrm{ATE}}\)` is the estimated ATE, `\(\widehat{\mu}_{Y(1)}\)` is the estimated `\(\mu_{Y(1)}\)`, and `\(\widehat{\mu}_{Y(0)}\)` is the estimated `\(\mu_{Y(0)}\)`.  
---
# ATT and ATU

- Average treatment on the treated

  - Effect for those with treatment

--
- Average treatment on the untreated

  - Effect for those without treatment


---

.smaller.sp-after[
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; Person &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Age &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Treated &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Outcome with program &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Outcome without program &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; Effect &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Old &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TRUE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **80** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 60 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **20** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Old &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TRUE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **75** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 70 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **5** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Old &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TRUE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **85** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **5** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Old &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; FALSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 70 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **60** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **10** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Young &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; TRUE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **75** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 70 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **5** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 6 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Young &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; FALSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 80 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **80** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **0** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 7 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Young &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; FALSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 90 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **100** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **-10** &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; Young &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; FALSE &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 85 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **80** &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; **5** &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.pull-left.small[
`\(\delta = (\bar{Y}_\text{T}\ |\ P = 1) - (\bar{Y}_\text{T}\ |\ P = 0)\)`

`\(\delta = (\bar{Y}_\text{U}\ |\ P = 1) - (\bar{Y}_\text{U}\ |\ P = 0)\)`
]

.pull-right.small[
`\(\text{CATE}_\text{Treated} = \frac{20 + 5 + 5 + 5}{4} = 8.75\)`

`\(\text{CATE}_\text{Untreated} = \frac{10 + 0 - 10 + 5}{4} = 1.25\)`
]

---

# Knowledge Check 1

- Designing an experiment: Suppose you are interested in the effect of the presence of vending machines in schools on childhood obesity. What controlled experiment would you want to do to evaluate this question?
---
# Knowledge Check 2

- Give the average treatment effect in the population and the estimated treatment effect based on a simple comparison of treatment and control

&lt;table class=" lightable-material-dark" style='font-family: "Source Sans Pro", helvetica, sans-serif; margin-left: auto; margin-right: auto;'&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; names &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; x &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; z &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; y0 &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; y1 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Cody &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Henna &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 10 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Jamie &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 3 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Branson &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 12 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Nicole &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 5 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 0 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Sarah &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 10 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 8 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 9 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Karen &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 2 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 4 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; Claire &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 11 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 1 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 9 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; 13 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;

    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true,
"background-image": "url(\"lover.png\")",
"background-size": "cover"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
